<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pan-Tilt HAT</title>
  <link href="/static/bootstrap.min.css" rel="stylesheet" media="screen"> 
  <script src="/static/jquery.js"></script>
    <script>


function createFrames() {
  var rows = 3;
  var columns = 5;
  var cell = "<td class=\"frame\"></td>";
  var table = `<tr>${cell.repeat(columns)}</tr>`.repeat(rows);
  $("#subframes").html(table);
};


function refreshFrames() {
  $(".frame").empty();
  $(".frame").html(function(index, old) {
    return `<img src="/static/frame${ index }.jpg?t=${ new Date().getTime() }">`
  });
};
    
$(function(){
  var isTouchDevice = "ontouchstart" in document.documentElement ? true : false;
  var BUTTON_DOWN   = isTouchDevice ? "touchstart" : "mousedown";
  var BUTTON_UP     = isTouchDevice ? "touchend"   : "mouseup";

  $(".camcontrol").bind(BUTTON_DOWN,function(){
    $.post("/cmd",this.id,function(data,status){});
  });

  $(".camcontrol").bind(BUTTON_UP,function(){
    $.post("/cmd","stop",function(data,status){});
  });

  $(".srvcontrol").bind(BUTTON_UP,function(){
    $.post("/srvcmd",this.id,function(data,status){});
  });

  createFrames();
  $("#refresh-frames").bind(BUTTON_UP,refreshFrames);
  
});

    
    </script>

  <style type="text/css">
    button {
      margin: 10px 15px 10px 15px;
      width: 50px;
      height: 50px;
    }
    input {
      margin: 10px 15px 10px 15px;
      width: 50px;
      height: 50px;
    }
</style>
  
</head>
<body>
<div id="container" class="container" align="center">
  <div style="width:60%; height:40px; line-height:40px; text-align:center; font-size:20px; color:white; background-color:blue; margin:auto">
  Pan-Tilt HAT Web Control
  </div><br><br>
  
  <table align="center">
    <tr>
      <td align="center"><b>Servo Control</b></td>
    </tr>
    <tr>
      <td>
        <div align="center">
          <table id="subframes">
            
          </table>
        </div>
        <div align="center">
          <button id="refresh-frames" class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-up refresh-frames"></button>
        </div>
        <div align="center">
          <button id="up" class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-up camcontrol"></button>
        </div>
        <div align="center">
          <button id='left' class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-left camcontrol"></button>
          <!--<button id='stop' class="btn btn-lg btn-primary glyphicon glyphicon-stop"></button>-->
          <button id='down' class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-down camcontrol"></button>
          <button id='right' class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-right camcontrol"></button>
        </div>
        <div align="center">
          <button id="recenter" class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-refresh camcontrol"></button>
        </div>
        <div align="center">
          <button id="refresh" class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-refresh srvcontrol"></button>
          <button id="shutdown" class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-down srvcontrol"></button>
        </div>
        <!-- </div> -->
        
      </td>
    </tr>
  </table>
</div>
</body>
</html>
